"use strict";angular.module("myApp.controllers").controller("AppCtrl",["$scope","USER_ROLES","AUTH_EVENTS","$rootScope","AuthService","modalService","Session","Restangular","$state","$ionicPopup","$ionicSideMenuDelegate",function(e,t,o,n,i,a,r,c,u,l,s){e.currentUser=null,e.userRoles=t,e.isAuthorized=i.isAuthorized,e.go=function(e){u.go(e)},window.ionic,e.toggleLeft=function(){s.toggleLeft(e.$$childHead)},n.base_url="http://federadati.provincia.rimini.it:3000",c.setBaseUrl(n.base_url+"/apiQ"),n.$on(o.loginSuccess,function(){e.currentUser=r.nome_breve_utenti,c.setDefaultRequestParams({apiKey:r.token}),u.go("menu.list")}),n.$on(o.logoutSuccess,function(){e.currentUser="",c.setDefaultRequestParams({apiKey:""}),u.go("menu.home")}),n.$on(o.loginFailed,function(){var e=l.alert({title:"Login errato",template:"Immettere nome utente e password corrette"});e.then(function(){u.go("menu.home")})}),n.$on(o.notAuthenticated,function(){e.currentUser=r.nome_breve_utenti;var t=l.alert({title:"Utente non autenticato",template:"Immettere nome utente e password"});t.then(function(){u.go("menu.home")})}),n.$on("$stateChangeStart",function(e,t){t.accessLogged&&(i.isAuthenticated()||(e.preventDefault(),n.$broadcast(o.notAuthenticated)))})}]).controller("LoginController",["$scope","$rootScope","AUTH_EVENTS","AuthService",function(e,t,o,n){e.credentials={username:"",password:""},e.leftButtons=[{type:"button-icon button-clear ion-navicon",tap:function(){$ionicSideMenuDelegate.toggleLeft(e.$$childHead)}}],e.navTitle='<span class="item-calm">Gestione Volontari</span>',e.login=function(e){n.login(e).then(function(){t.$broadcast(o.loginSuccess)},function(){t.$broadcast(o.loginFailed)})},e.logout=function(e){n.logout(e).then(function(){t.$broadcast(o.logoutSuccess)},function(){t.$broadcast(o.logoutSuccess)})}}]).controller("AboutController",["$scope","$rootScope","AUTH_EVENTS","AuthService","Session","$location","$ionicLoading",function(e,t,o,n,i,a,r){e.navTitle=i.nome_breve_utenti,e.base_url=t.base_url,e.$location={},r.show({template:"Loading..."}),angular.forEach("protocol host port path search hash".split(" "),function(t){e.$location[t]=function(){var e=a[t].call(a);return angular.isObject(e)?angular.toJson(e):e}}),r.hide()}]);